$(document).ready(function(){wxImgOpt.init(),wxImgOpt.bindings()});var wxImgOpt=function(){function n(){$(".commit-info").click(function(){1==sfid?swal({title:"",text:"参加活动请先关注荔枝妈妈.",imageUrl:mengbaoTools.randomPic(),showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"图文教程",cancelButtonText:"取消",closeOnConfirm:!1},function(){window.location.href="http://mp.weixin.qq.com/s?__biz=MzI5ODAwNTY2MA==&mid=207512386&idx=1&sn=d2e302c89ba38c96069c96f921847921&scene=0#rd"}):e()})}function e(){""==$(".nickname").val()?alert("请填写名字"):11!=$(".phone").val().length?alert("请填写11位手机号码，以方便我们联系到您！"):0==u.length?alert("参赛必须要上传一张以上的宝宝图片!"):$.post("/baby",{"user.id":sfid,images:u,name:$(".nickname").val(),phone:$(".phone").val(),description:$(".description").val(),platformId:"8af5535b4ef90b7d014efb8fc3f00bec"},function(n){alert("恭喜你，报名成功!"),window.location.href="center.html?sfid="+sfid})}function o(){var n=window.location.href,e="/wxpay/prepare";$.ajax({type:"post",url:e,data:{curl:n,platformId:"8af5535b4ef90b7d014efb8fc3f00bec"},success:function(n){wx.config({debug:!1,appId:n.appid,timestamp:n.timestamp,nonceStr:n.noncestr,signature:n.sign_result,jsApiList:["chooseImage","uploadImage","downloadImage","previewImage"]})},error:function(n){console.log("ERROR:",n)}})}function c(){wx.checkJsApi({jsApiList:["chooseImage"],success:function(n){n.checkResult.chooseImage||alert("请使用微信客户端6.0.2或更高版本！")}})}function i(){wx.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(n){f=n.localIds,a(f),$("#preview-imgs").append(r(f))}})}function t(n,e){wx.previewImage({current:n,urls:e})}function a(n){for(var e=0;e<n.length;e++)s(n[e])}function s(n){wx.uploadImage({localId:n,isShowProgressTips:1,success:function(n){u.push(n.serverId)}})}function r(n){for(var e="",o=0;o<n.length;o++)e+='<img style="width:100px;" src="'+n[o]+'">';return e}var f=[],u=[];return{init:function(){o()},check:function(){c()},chooseImage:function(){i()},previewImage:function(){t()},bindings:function(){n()}}}();wx.ready(function(){wxImgOpt.check(),$(".choose-pic").click(function(){wxImgOpt.chooseImage()})}),wx.error(function(n){console.log(n)});