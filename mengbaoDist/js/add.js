$(document).ready(function(){wxImgOpt.init(),wxImgOpt.bindings()});var wxImgOpt=function(){function e(){$(".commit-info").click(function(){$(".test-text").text(u),$.post("/baby",{"user.id":sfid,images:u,name:$(".nickname").val(),phone:$(".phone").val(),declaration:$(".description").val(),platformId:"8af5535b4ef90b7d014efb8fc3f00bec"},function(e){alert("保存成功!")})})}function n(){var e=window.location.href,n="/wxpay/prepare";$.ajax({type:"post",url:n,data:{curl:e,platformId:"8af5535b4ef90b7d014efb8fc3f00bec"},success:function(e){wx.config({debug:!1,appId:e.appid,timestamp:e.timestamp,nonceStr:e.noncestr,signature:e.sign_result,jsApiList:["chooseImage","uploadImage","downloadImage","previewImage"]})},error:function(e){console.log("ERROR:",e)}})}function o(){wx.checkJsApi({jsApiList:["chooseImage"],success:function(e){e.checkResult.chooseImage||alert("请使用微信客户端6.0.2或更高版本！")}})}function c(){wx.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){r=e.localIds,$("#preview-imgs").append(a(r)),t(r)}})}function i(e,n){wx.previewImage({current:e,urls:n})}function t(e){for(var n=0;n<e.length;n++)s(e[n])}function s(e){wx.uploadImage({localId:e,isShowProgressTips:1,success:function(e){u.push(e.serverId)}})}function a(e){for(var n="",o=0;o<e.length;o++)n+='<img style="width:100px;" src="'+e[o]+'">';return n}var r=[],u=[];return{init:function(){n()},check:function(){o()},chooseImage:function(){c()},previewImage:function(){i()},bindings:function(){e()}}}();wx.ready(function(){wxImgOpt.check(),$(".choose-pic").click(function(){wxImgOpt.chooseImage()})}),wx.error(function(e){console.log(e)});