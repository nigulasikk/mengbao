$(document).ready(function(){wxImgOpt.init(),wxImgOpt.bindings()});var wxImgOpt=function(){function n(){$(".commit-info").click(function(){alert("serverIds:"+u),$.post("/baby",{"user.id":sfid,images:u,name:$(".nickname").val(),phone:$(".phone").val(),declaration:$(".description").val()},function(n){alert("保存成功!")})})}function e(){var n=window.location.href,e="/wxpay/prepare";$.ajax({type:"post",url:e,data:{curl:n},success:function(n){wx.config({debug:!1,appId:n.appid,timestamp:n.timestamp,nonceStr:n.noncestr,signature:n.sign_result,jsApiList:["chooseImage","uploadImage","downloadImage","previewImage"]})},error:function(n){console.log("ERROR:",n)}})}function o(){wx.checkJsApi({jsApiList:["chooseImage"],success:function(n){n.checkResult.chooseImage||alert("请使用微信客户端6.0.2或更高版本！")}})}function c(){wx.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(n){r=n.localIds,$("#preview-imgs").append(a(r)),t(r)}})}function i(n,e){wx.previewImage({current:n,urls:e})}function t(n){for(var e=0;e<n.length;e++)s(n[e])}function s(n){wx.uploadImage({localId:n,isShowProgressTips:1,success:function(n){u.push(n.serverId)}})}function a(n){for(var e="",o=0;o<n.length;o++)e+='<img style="width:100px;" src="'+n[o]+'">';return e}var r=[],u=[];return{init:function(){e()},check:function(){o()},chooseImage:function(){c()},previewImage:function(){i()},bindings:function(){n()}}}();wx.ready(function(){wxImgOpt.check(),$(".choose-pic").click(function(){wxImgOpt.chooseImage()})}),wx.error(function(n){console.log(n)});